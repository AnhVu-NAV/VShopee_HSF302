<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head}">
    <title>Thanh to√°n ƒë∆°n h√†ng - VShopper</title>
</head>
<body id="page-body" class="bg-light text-dark d-flex flex-column min-vh-100">

<!-- ‚úÖ Navbar -->
<nav th:replace="~{layout :: navbar}"></nav>

<main class="container mt-5 flex-fill">
    <h2 class="text-success mb-4">üí≥ Thanh to√°n ƒë∆°n h√†ng</h2>

    <form th:action="@{/cart/confirm-payment}" method="post">
        <div class="row">
            <!-- B√™n tr√°i: Th√¥ng tin ƒë∆°n h√†ng -->
            <div class="col-md-7 mb-4">
                <div class="card shadow-sm p-4">
                    <h5 class="mb-3">Th√¥ng tin ng∆∞·ªùi nh·∫≠n</h5>

                    <div class="mb-3">
                        <label for="fullname" class="form-label">H·ªç t√™n</label>
                        <input type="text" class="form-control" id="fullname" name="fullname"
                               th:value="${user.fullname}" readonly>
                    </div>

                    <div class="mb-3">
                        <label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" class="form-control" id="phone" name="phone"
                               th:value="${user.phone != null ? user.phone : ''}"
                               placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
                    </div>

                    <div class="mb-3">
                        <label for="address" class="form-label">ƒê·ªãa ch·ªâ giao h√†ng</label>
                        <textarea class="form-control" id="address" name="address" rows="2"
                                  placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ" required
                                  th:text="${user.address != null ? user.address : ''}"></textarea>
                    </div>

                    <hr>

                    <h5 class="mb-3">S·∫£n ph·∫©m trong ƒë∆°n h√†ng</h5>
                    <ul class="list-group mb-3">
                        <li class="list-group-item d-flex justify-content-between align-items-center"
                            th:each="item : ${cartItems}">
                            <div>
                                <strong th:text="${item.product.name}">T√™n s·∫£n ph·∫©m</strong>
                                <div class="text-muted small">x <span th:text="${item.quantity}">1</span></div>
                            </div>
                            <span th:text="${#numbers.formatDecimal(item.subtotal, 0, 'POINT', 0, 'COMMA')} + ' ƒë'">200.000 ƒë</span>
                        </li>
                    </ul>

                    <div class="d-flex justify-content-between">
                        <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                        <strong class="text-success">Mi·ªÖn ph√≠</strong>
                    </div>

                    <div class="d-flex justify-content-between fs-5 mt-2">
                        <span>T·ªïng c·ªông:</span>
                        <strong th:text="${#numbers.formatDecimal(total, 0, 'POINT', 0, 'COMMA')} + ' ƒë'">0 ƒë</strong>
                    </div>
                </div>
            </div>

            <!-- B√™n ph·∫£i: QR v√† n√∫t x√°c nh·∫≠n -->
            <div class="col-md-5 mb-4">
                <div class="card shadow-sm p-4 text-center">
                    <h5 class="mb-3">Qu√©t m√£ VietQR ƒë·ªÉ thanh to√°n</h5>
                    <img th:src="${qrUrl}" alt="QR Thanh to√°n"
                         class="img-fluid d-block mx-auto mb-3"
                         style="max-width: 300px;">
                    <p class="text-muted">Vui l√≤ng chuy·ªÉn ƒë√∫ng s·ªë ti·ªÅn v√† ghi r√µ n·ªôi dung thanh to√°n.</p>

                    <input type="hidden" name="paymentMethod" value="VietQR">

                    <button type="submit" class="btn btn-success btn-lg w-100">X√°c nh·∫≠n ƒë√£ chuy·ªÉn kho·∫£n</button>
                </div>
            </div>
        </div>
    </form>
</main>

<!-- ‚úÖ Footer -->
<footer th:replace="~{layout :: footer}"></footer>

<!-- ‚úÖ Scripts -->
<div th:replace="~{layout :: script}"></div>

</body>
</html>
